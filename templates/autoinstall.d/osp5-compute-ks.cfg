{% extends "rhel-7-min-ks.cfg" %}

{% block firewall -%}
# FIXME: Which ports must be opened ?
# :see: https://github.com/redhat-openstack/astapor/blob/master/puppet/modules/quickstack/manifests/firewall/nova.pp
#firewall --enabled --ssh --port=8774:tcp --port=8775:tcp --port=6080:tcp --port=6081:tcp
firewall --enabled --ssh
{%- endblock %}

{% block packages_installed -%}
{{ super() }}
ntp
patch
{%- endblock %}

{% block post_last -%}
{{   super() }}
repofile=/root/setup/localrepo.repo
if [ -f ${repofile} ]; then
	cp ${repofile} /etc/yum.repos.d/
fi
{%   include "snippets/post.osp5.yum" %}
{% endblock %}
{#
{% block post_last -%}
{{   super() }}
{%   include "snippets/post.osp5.tarball" %}
{%   include "snippets/post.osp5.permission" %}
{%   include "snippets/post.osp5.yum" %}

# for RHEL-OSP + RHS
#setsebool -P sanlock_use_fusefs on
#setsebool -P virt_use_sanlock on
#setsebool -P virt_use_fusefs on
chown -R root:root /root/setup
{% endblock %}
#}

{% block post -%}
{{   super() }}
{# {%   include "snippets/post.generate_etc_sysconfig_network_files_for_openstack" -%} #}
{%   include "snippets/post.generate_etc_sysconfig_network_files" -%}
{% endblock %}
